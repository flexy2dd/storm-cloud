<!DOCTYPE html>
<html>
<title>Stormcloud control</title>
<head>
  <link rel="icon" type="image/png" href="/static/favicon.png" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="/static/mdl/1.3.0/material.min.css">
  <link rel="stylesheet" href="/static/mdl/mdl-selectfield-master/dist/mdl-selectfield.min.css">
  <link rel="stylesheet" href="/static/styles.css">
  <script defer src="/static/mdl/1.3.0/material.min.js"></script>
  <script defer src="/static/mdl/mdl-selectfield-master/dist/mdl-selectfield.min.js"></script>
  <script src="/static/jquery/3.6.0/jquery-3.6.0.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>

  </style>
</head>
<body>
<div class="mdl-layout mdl-js-layout mdl-layout--fixed-header">
  <header class="mdl-layout__header">
    <div class="mdl-layout__header-row">
        <!-- Title -->
        <span class="mdl-layout-title">Storm cloud</span>
        <!-- Add spacer, to align navigation to the right -->
        <div class="mdl-layout-spacer"></div>
        <!-- Navigation -->
      </div>
    </header>
    <div class="mdl-layout__drawer">
      <span class="mdl-layout-title">Storm cloud</span>
      <nav class="mdl-navigation">
        <a class="mdl-navigation__link" href="#0" id="btn-snooze">Snooze</a>
        <div class="android-drawer-separator"></div>
        <span class="mdl-navigation__link" href="">Paramètres</span>
        <a class="mdl-navigation__link" href="#0" id="btn-volume">Volume</a>
        <a class="mdl-navigation__link" href="#0" id="btn-rain">Pluie</a>
        <a class="mdl-navigation__link" href="#0" id="btn-thunder">Orage</a>
      </nav>
    </div>
    <main class="mdl-layout__content">

      <div style="" id="panel-snooze">
        <div class="mdl-grid">
          <div class="mdl-cell mdl-cell--1-col">
            <div class="demo-card-wide mdl-card mdl-shadow--2dp">
              <div class="mdl-card__title">
                <h2 class="mdl-card__title-text">Temps restant</h2>
              </div>
              <div class="mdl-card__supporting-text">
                <h2 id="panel-remainging">00:00</h2>
              </div>
              <div class="mdl-card__supporting-text" id="panel-playing">
              </div>
              <div class="mdl-card__menu">
                <button id="btn-stop-snooze" class="mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect">
                  <i class="material-icons">alarm_off</i>
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="mdl-grid">
          <div class="mdl-cell mdl-cell--2-col">
            <div class="demo-card-wide mdl-card mdl-shadow--2dp">
              <div class="mdl-card__title">
                <h2 class="mdl-card__title-text">Demarrer</h2>
              </div>
              <div class="mdl-card__supporting-text">

                <table>
                  <tbody>
                    <tr>
                      <td style="width:200px">
                        <h2 id="panel-snooze-current" data-minutes="0">00:00</h2>
                      </td>
                      <td>
                
                        <table>
                          <tbody>
                            <tr>
                              <td>
                                <button id="btn-add-snooze" class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored">
                                  <i class="material-icons">add</i>
                                </button>
                              </td>
                            <tr>
                          </tr>
                              <td>
                                <button id="btn-remove-snooze" class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored">
                                  <i class="material-icons">remove</i>
                                </button>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </td>
                    </tr>
<!--
                    <tr>
                      <td style="width:200px">
                        <button id="btn-launch-snooze" class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect">
                          <i class="material-icons">alarm_on</i>
                        </button>
                      </td>
                    </tr>
-->
                  </tbody>
                </table>

              </div>
<!--
              <div class="mdl-card__actions mdl-card--border">
                <a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">
                  Get Started
                </a>
              </div>
-->
              <div class="mdl-card__menu">
                <button id="btn-launch-snooze" class="mdl-button mdl-button--icon mdl-js-button mdl-js-ripple-effect">
                  <i class="material-icons">alarm_on</i>
                </button>
              </div>
            </div>
          </div>

        </div>
      </div>

      <div style="display:none;" id="panel-rain">

        <div class="mdl-grid">
          <div class="mdl-cell mdl-cell--1-col">
            <div class="demo-card-wide mdl-card mdl-shadow--2dp">
              <div class="mdl-card__title">
                <h2 class="mdl-card__title-text">Pluie</h2>
              </div>
              <div class="mdl-card__supporting-text">
                

                <table class="">
                  <tbody>
                    <tr>
                      <td>
                        <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="rain-0" style="display:block;">
                          <input type="radio" id="rain-0" class="mdl-radio__button" name="btn-rain" value="0">
                          <span class="mdl-radio__label">Aucune</span>
                        </label>
                      </td>
                      <td>
                    </tr>

                    <tr>
                      <td>
                        <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="rain-1" style="display:block;">
                          <input type="radio" id="rain-1" class="mdl-radio__button" name="btn-rain" value="1">
                          <span class="mdl-radio__label">Légère</span>
                        </label>
                      </td>
                      <td>
                        <div class="mdl-selectfield mdl-js-selectfield">
                          <select class="mdl-selectfield__select" id="btn-rain-select-1" name="btn-rain-select-1">
                            <option value=""></option>
                          </select>
                          <label class="mdl-selectfield__label" for="btn-rain-select-1"></label>
                        </div>
                      </td>
                    </tr>

                    <tr>
                      <td>
                        <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="rain-2" style="display:block;">
                          <input type="radio" id="rain-2" class="mdl-radio__button" name="btn-rain" value="2">
                          <span class="mdl-radio__label">Modérée</span>
                        </label>
                      </td>
                      <td>
                        <div class="mdl-selectfield mdl-js-selectfield">
                          <select class="mdl-selectfield__select" id="btn-rain-select-2" name="btn-rain-select-2">
                            <option value=""></option>
                          </select>
                          <label class="mdl-selectfield__label" for="btn-rain-select-2"></label>
                        </div>
                      </td>
                    </tr>

                    <tr>
                      <td>
                        <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="rain-3" style="display:block;">
                          <input type="radio" id="rain-3" class="mdl-radio__button" name="btn-rain" value="3">
                          <span class="mdl-radio__label">Forte</span>
                        </label>
                      </td>
                      <td>
                        <div class="mdl-selectfield mdl-js-selectfield">
                          <select class="mdl-selectfield__select" id="btn-rain-select-3" name="btn-rain-select-3">
                            <option value=""></option>
                          </select>
                          <label class="mdl-selectfield__label" for="btn-rain-select-3"></label>
                        </div>
                      </td>
                    </tr>

                  </tbody>
                </table>

              </div>
              <div class="mdl-card__menu">
              </div>
            </div>
          </div>
        </div>
      </div>

      <div style="display:none;" id="panel-thunder">
        <div class="mdl-grid">
          <div class="mdl-cell mdl-cell--1-col">
            <div class="demo-card-wide mdl-card mdl-shadow--2dp">
              <div class="mdl-card__title">
                <h2 class="mdl-card__title-text">Orage</h2>
              </div>
              <div class="mdl-card__supporting-text">
                <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="thunder-0" style="display:block;">
                  <input type="radio" id="thunder-0" class="mdl-radio__button" name="btn-thunder" value="0">
                  <span class="mdl-radio__label">Aucun</span>
                </label>
                <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="thunder-1" style="display:block;">
                  <input type="radio" id="thunder-1" class="mdl-radio__button" name="btn-thunder" value="1">
                  <span class="mdl-radio__label">Léger</span>
                </label>
                <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="thunder-2" style="display:block;">
                  <input type="radio" id="thunder-2" class="mdl-radio__button" name="btn-thunder" value="2">
                  <span class="mdl-radio__label">Modéré</span>
                </label>
                <label class="mdl-radio mdl-js-radio mdl-js-ripple-effect" for="thunder-3" style="display:block;">
                  <input type="radio" id="thunder-3" class="mdl-radio__button" name="btn-thunder" value="3">
                  <span class="mdl-radio__label">Fort</span>
                </label>
              </div>
              <div class="mdl-card__menu" style="width: 92px;">
                <i class="material-icons" style="float: left;">flash_on</i>
                <label class="mdl-switch mdl-js-switch mdl-js-ripple-effect" for="btn-light" id="switch-light" style="float: left;width: 66px;">
                  <input type="checkbox" id="btn-light" class="mdl-switch__input">
                  <span class="mdl-switch__label"></span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <div class="mdl-grid">
          <div class="mdl-cell mdl-cell--2-col">
            <div class="demo-card-wide mdl-card mdl-shadow--2dp">
              <div class="mdl-card__title">
                <h2 class="mdl-card__title-text">Volume</h2>
              </div>
              <div class="mdl-card__supporting-text">
                <table>
                  <tbody>
                    <tr>
                      <td style="width:200px">
                        <h2 id="panel-thunder-volume-current" data-volume="0">0%</h2>
                      </td>
                      <td>
                        <table>
                          <tbody>
                            <tr>
                              <td>
                                <button id="btn-add-thunder-volume" class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored">
                                  <i class="material-icons">add</i>
                                </button>
                              </td>
                            <tr>
                          </tr>
                              <td>
                                <button id="btn-remove-thunder-volume" class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored">
                                  <i class="material-icons">remove</i>
                                </button>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="mdl-card__menu"></div>
            </div>
          </div>
        </div>

        <div class="mdl-grid">
          <div class="mdl-cell mdl-cell--2-col">
            <div class="demo-card-wide mdl-card mdl-shadow--2dp">
              <div class="mdl-card__title">
                <h2 class="mdl-card__title-text">Delta</h2>
              </div>
              <div class="mdl-card__supporting-text">
                <table>
                  <tbody>
                    <tr>
                      <td style="width:200px">
                        <h3 id="panel-thunder-deltamin-current" data-volume="0">Min 0s</h3>
                      </td>
                      <td>
                        <table>
                          <tbody>
                            <tr>
                              <td>
                                <button id="btn-add-thunder-deltamin" class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored">
                                  <i class="material-icons">add</i>
                                </button>
                              </td>
                            <tr>
                          </tr>
                              <td>
                                <button id="btn-remove-thunder-deltamin" class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored">
                                  <i class="material-icons">remove</i>
                                </button>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </td>
                    </tr>
                  </tbody>
                </table>
                <table>
                  <tbody>
                    <tr>
                      <td style="width:200px">
                        <h3 id="panel-thunder-deltamax-current" data-volume="0">Max 0s</h3>
                      </td>
                      <td>
                        <table>
                          <tbody>
                            <tr>
                              <td>
                                <button id="btn-add-thunder-deltamax" class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored">
                                  <i class="material-icons">add</i>
                                </button>
                              </td>
                            <tr>
                          </tr>
                              <td>
                                <button id="btn-remove-thunder-deltamax" class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored">
                                  <i class="material-icons">remove</i>
                                </button>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="mdl-card__menu"></div>
            </div>
          </div>
        </div>

      </div>

      <div style="display:none;" id="panel-volume">
        <div class="mdl-grid">
          <div class="mdl-cell mdl-cell--2-col">
            <div class="demo-card-wide mdl-card mdl-shadow--2dp">
              <div class="mdl-card__title">
                <h2 class="mdl-card__title-text">Volume</h2>
              </div>
              <div class="mdl-card__supporting-text">
                <table>
                  <tbody>
                    <tr>
                      <td style="width:200px">
                        <h2 id="panel-volume-current" data-volume="0">0</h2>
                      </td>
                      <td>
                        <table>
                          <tbody>
                            <tr>
                              <td>
                                <button id="btn-add-volume" class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored">
                                  <i class="material-icons">add</i>
                                </button>
                              </td>
                            <tr>
                          </tr>
                              <td>
                                <button id="btn-remove-volume" class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored">
                                  <i class="material-icons">remove</i>
                                </button>
                              </td>
                            </tr>
                          </tbody>
                        </table>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="mdl-card__menu"></div>
            </div>
          </div>

        </div>

      </div>

    </main>
  </div>

  <script src="/static/socket.io/4.0.0/socket.io.js"></script>
  <script>
    const zeroPad = (num, places) => String(num).padStart(places, '0')

    var socket = io.connect(); //load socket.io-client and connect to the host

    function checkRemaining() {
      socket.emit("check_remaining", 0);
      socket.emit("check_playing");
      setTimeout(function(){ 
          checkRemaining();
        }, 
        1000
      );
    }

    function fillRainSelect(rainLevel) {
      $('#btn-rain-select-' + rainLevel).empty();
      $.ajax({
          type:'GET',
          url:'http://stormcloud.local/rest/rain/list?rain=' + rainLevel,
          cache:false,
          success:function(data){ 
            aData = JSON.parse(data)
            $.each(aData, function(i,item) {
              $('#btn-rain-select-' + rainLevel).append('<option ' + (item.selected ? 'selected="selected"' : '') + ' value="' + item.root + '">' + item.root + '</option>');
            });
          },
          error:function(){alert("Connection Is Not Available");}
      });
    }

    function minuteToHHMM(minutes) {
      var hours = (minutes / 60);
      var rhours = Math.floor(hours);
      var minutes = (hours - rhours) * 60;
      var rminutes = Math.round(minutes);
      return zeroPad(rhours, 2) + ':' + zeroPad(rminutes, 2);
    }

    $( document ).ready(function() {

      // snooze menu
      $('#btn-snooze').on('click', function(event) {
        event.preventDefault();
        $('#panel-rain').hide();
        $('#panel-thunder').hide();
        $('#panel-volume').hide();
        $('#panel-snooze').show();
        document.querySelector('.mdl-layout').MaterialLayout.toggleDrawer();
      });

      // rain menu
      $('#btn-rain').on('click', function(event) {
        event.preventDefault();
        $('#panel-rain').show();
        $('#panel-thunder').hide();
        $('#panel-volume').hide();
        $('#panel-snooze').hide();
        document.querySelector('.mdl-layout').MaterialLayout.toggleDrawer();
      });
      
      // thunder menu
      $('#btn-thunder').on('click', function(event) {
        event.preventDefault();
        $('#panel-rain').hide();
        $('#panel-thunder').show();
        $('#panel-volume').hide();
        $('#panel-snooze').hide();
        document.querySelector('.mdl-layout').MaterialLayout.toggleDrawer();
      });

      // volume menu
      $('#btn-volume').on('click', function(event) {
        event.preventDefault();
        $('#panel-rain').hide();
        $('#panel-thunder').hide();
        $('#panel-volume').show();
        $('#panel-snooze').hide();
        document.querySelector('.mdl-layout').MaterialLayout.toggleDrawer();
      });

      // update playing
      socket.on("update_playing", (data) => {
        $('#panel-playing').text(data.playing)
      });

      // update remaining
      socket.on("update_remaining", (data) => {
        $('#panel-remainging').text(minuteToHHMM(data.remainingSeconds/60))
      });

      // snooze update
      socket.emit("get_snooze", 0);
      socket.on("update_snooze", (data) => {
        $('#panel-snooze-current').attr("data-minutes", data.snooze);
        $("#panel-snooze-current").text(minuteToHHMM(data.snooze));
      });

      // snooze duration
      $("#btn-remove-snooze").on("click", function(event) {
        var currentSnooze = $("#panel-snooze-current").data('minutes');

        currentSnooze = currentSnooze - 15;
        if (currentSnooze<0)
          currentSnooze = 0;

        $('#panel-snooze-current').attr("data-minutes", currentSnooze);
        $("#panel-snooze-current").text(minuteToHHMM(currentSnooze));
      });
      $("#btn-add-snooze").on("click", function(event) {
        var currentSnooze = $("#panel-snooze-current").data('minutes');

        currentSnooze = currentSnooze + 15;
        if (currentSnooze>1440)
          currentSnooze = 1440;

        $('#panel-snooze-current').attr("data-minutes", currentSnooze);
        $("#panel-snooze-current").text(minuteToHHMM(currentSnooze));
      });

      // launch snooze
      $("#btn-launch-snooze").on("click", function(event) {
        event.preventDefault();
        var currentSnooze = $("#panel-snooze-current").data('minutes');
        socket.emit("launch_snooze", currentSnooze);
      });
      $("#btn-stop-snooze").on("click", function(event) {
        event.preventDefault();
        socket.emit("stop_snooze", 0);
      });

      // rain level
      socket.emit("get_rain");
      socket.on("update_rain", (data) => {
        document.getElementById('rain-' + data.rain).parentNode.MaterialRadio.check();
      });
      $('input[type=radio][name=btn-rain]').change(function() {
          socket.emit("set_rain", this.value);
      });

      // thunder level
      socket.emit("get_thunder");
      socket.on("update_thunder", (data) => {
        document.getElementById('thunder-' + data.thunder).parentNode.MaterialRadio.check();
      });
      $('input[type=radio][name=btn-thunder]').change(function() {
          socket.emit("set_thunder", this.value);
      });

      // thunder light
      socket.emit("get_light");
      socket.on("update_light", (data) => {
        if (data.light==1)
          $('#switch-light')[0].MaterialSwitch.on();
        else
          $('#switch-light')[0].MaterialSwitch.off();
      });
      $('#btn-light').change(function(){
        if($(this).is(':checked'))
          socket.emit("set_light", 1);
        else
          socket.emit("set_light", 0);
      });

      // thunder volume
      socket.emit("get_thunder_volume");
      socket.on("update_thunder_volume", (data) => {
        $('#panel-thunder-volume-current').data("volume", data.volume);
        $("#panel-thunder-volume-current").text(data.volume + ' %');
      });

      $("#btn-remove-thunder-volume").on("click", function(event) {
        var volume = $("#panel-thunder-volume-current").data('volume');

        volume = parseInt(volume) - 1;
        if (volume<1)
          volume = 1;

        $('#panel-thunder-volume-current').data("volume", volume);
        $("#panel-thunder-volume-current").text(volume + ' %');
        socket.emit("set_thunder_volume", volume);
      });
      $("#btn-add-thunder-volume").on("click", function(event) {
        var volume = $("#panel-thunder-volume-current").data('volume');

        volume = parseInt(volume) + 1;
        if (volume>100)
          volume = 100;

        $('#panel-thunder-volume-current').data("volume", volume);
        $("#panel-thunder-volume-current").text(volume + ' %');
        socket.emit("set_thunder_volume", volume);
      });

      // thunder deltas
      socket.emit("get_thunder_deltas");
      socket.on("update_thunder_deltas", (data) => {
        $('#panel-thunder-deltamin-current').data("deltamin", data.deltas.min);
        $('#panel-thunder-deltamax-current').data("deltamax", data.deltas.max);
        $("#panel-thunder-deltamin-current").text('Min ' + data.deltas.min + 's');
        $("#panel-thunder-deltamax-current").text('Max ' + data.deltas.max + 's');
      });

      // thunder deltas min
      $("#btn-remove-thunder-deltamin").on("click", function(event) {
        var deltaMin = $("#panel-thunder-deltamin-current").data('deltamin');
        var deltaMax = $("#panel-thunder-deltamax-current").data('deltamax');

        deltaMin = parseInt(deltaMin) - 1;
        if (deltaMin<1)
          deltaMin = 1;

        $('#panel-thunder-deltamin-current').data("deltamin", deltaMin);
        $("#panel-thunder-deltamin-current").text('Min ' + deltaMin + 's');
        socket.emit("set_thunder_deltas", {'min': deltaMin, 'max': deltaMax});
      });
      $("#btn-add-thunder-deltamin").on("click", function(event) {
        var deltaMin = $("#panel-thunder-deltamin-current").data('deltamin');
        var deltaMax = $("#panel-thunder-deltamax-current").data('deltamax');

        deltaMin = parseInt(deltaMin) + 1;
        if (deltaMin>100)
          deltaMin = 100;

        if (deltaMin>=deltaMax)
          deltaMin = deltaMax - 1

        $('#panel-thunder-deltamin-current').data("deltamin", deltaMin);
        $("#panel-thunder-deltamin-current").text('Min ' + deltaMin + 's');
        socket.emit("set_thunder_deltas", {'min': deltaMin, 'max': deltaMax});
      });
      
      // thunder deltas max
      $("#btn-remove-thunder-deltamax").on("click", function(event) {
        var deltaMin = $("#panel-thunder-deltamin-current").data('deltamin');
        var deltaMax = $("#panel-thunder-deltamax-current").data('deltamax');

        deltaMax = parseInt(deltaMax) - 1;
        if (deltaMax<1)
          deltaMax = 1;

        if (deltaMax<=deltaMin)
          deltaMax = deltaMin + 1

        $('#panel-thunder-deltamax-current').data("deltamax", deltaMax);
        $("#panel-thunder-deltamax-current").text('Max ' + deltaMax + 's');
        socket.emit("set_thunder_deltas", {'min': deltaMin, 'max': deltaMax});
      });
      $("#btn-add-thunder-deltamax").on("click", function(event) {
        var deltaMin = $("#panel-thunder-deltamin-current").data('deltamin');        
        var deltaMax = $("#panel-thunder-deltamax-current").data('deltamax');

        deltaMax = parseInt(deltaMax) + 1;
        if (deltaMax>100)
          deltaMax = 100;

        $('#panel-thunder-deltamax-current').data("deltamax", deltaMax);
        $("#panel-thunder-deltamax-current").text('Max ' + deltaMax + 's');
        socket.emit("set_thunder_deltas", {'min': deltaMin, 'max': deltaMax});
      });

      // general volume
      socket.emit("get_volume");
      socket.on("update_volume", (data) => {
        $('#panel-volume-current').data("volume", data.volume);
        $("#panel-volume-current").text(data.volume);
      });
      $("#btn-remove-volume").on("click", function(event) {
        var volume = $("#panel-volume-current").data('volume');

        volume = parseInt(volume) - 1;
        if (volume<0)
          volume = 0;

        $('#panel-volume-current').data("volume", volume);
        $("#panel-volume-current").text(volume);
        socket.emit("set_volume", volume);
      });
      $("#btn-add-volume").on("click", function(event) {
        var volume = $("#panel-volume-current").data('volume');

        volume = parseInt(volume) + 1;
        if (volume>100)
          volume = 100;

        $('#panel-volume-current').data("volume", volume);
        $("#panel-volume-current").text(volume);
        socket.emit("set_volume", volume);
      });

      // init
      fillRainSelect(1);
      fillRainSelect(2);
      fillRainSelect(3);
      
      $("#btn-rain-select-1").on("change", function(event) {
        var rainSelect = $("#btn-rain-select-1").val();
        socket.emit("set_rain_select", 1, rainSelect);
      });
      $("#btn-rain-select-2").on("change", function(event) {
        var rainSelect = $("#btn-rain-select-2").val();
        socket.emit("set_rain_select", 2, rainSelect);
      });
      $("#btn-rain-select-3").on("change", function(event) {
        var rainSelect = $("#btn-rain-select-3").val();
        socket.emit("set_rain_select", 3, rainSelect);
      });
      socket.on("update_rain_select", (data) => {
        $('##btn-rain-select-' + data.rain + ' option[value="' + data.rainSelect + '"]').prop('selected', true);
      });

      checkRemaining();
    });
      
  </script>
</html>
</body>

</html>